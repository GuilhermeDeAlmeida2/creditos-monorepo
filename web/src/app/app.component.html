<div class="app-container">
  <header class="app-header">
    <div class="header-content">
      <h1>Sistema de Cr√©ditos Constitu√≠dos</h1>
      <p>Gerenciamento e consulta de cr√©ditos por NFS-e</p>
    </div>
    <div class="connection-status">
      <app-button 
        [variant]="getConnectionButtonVariant()"
        size="small"
        [loading]="loading"
        (clicked)="pingApi()">
        {{ loading ? 'Testando...' : (result ? 'Conectado' : 'Testar Conex√£o') }}
      </app-button>
    </div>
  </header>

  <main class="app-main">
    <nav class="tab-nav">
      <button 
        class="tab-btn" 
        [class.active]="activeTab === 'creditos'"
        (click)="activeTab = 'creditos'">
        <span class="tab-icon">üìã</span>
        Buscar Cr√©ditos
      </button>
      <button 
        class="tab-btn" 
        [class.active]="activeTab === 'buscar-credito'"
        (click)="activeTab = 'buscar-credito'">
        <span class="tab-icon">üîç</span>
        Buscar por N√∫mero do Cr√©dito
      </button>
    </nav>

    <div class="tab-content">
      <div *ngIf="activeTab === 'creditos'" class="tab-panel">
        <app-creditos></app-creditos>
      </div>
      
      <div *ngIf="activeTab === 'buscar-credito'" class="tab-panel">
        <div class="buscar-credito-panel">
          <div class="buscar-credito-container">
            <!-- Card de busca -->
            <app-card 
              title="Buscar Cr√©dito por N√∫mero"
              variant="elevated"
              class="search-card">
              <div class="search-form">
                <app-input
                  type="text"
                  placeholder="Digite o n√∫mero do cr√©dito"
                  [(ngModel)]="numeroCredito"
                  (enterKey)="buscarCreditoPorNumero()"
                  [showClearButton]="true">
                </app-input>
                <app-button 
                  variant="primary"
                  [disabled]="loadingCredito || !numeroCredito.trim()"
                  [loading]="loadingCredito"
                  (clicked)="buscarCreditoPorNumero()">
                  {{ loadingCredito ? 'Buscando...' : 'Buscar' }}
                </app-button>
              </div>
            </app-card>

            <!-- Mensagem de erro -->
            <app-error-message 
              *ngIf="errorMessageCredito" 
              type="error"
              [message]="errorMessageCredito"
              [dismissible]="true">
            </app-error-message>

            <!-- Card de resultado -->
            <app-card 
              *ngIf="creditoDetalhes && !loadingCredito"
              title="Detalhes do Cr√©dito"
              variant="default"
              class="result-card">
              <div class="credito-details">
                <div class="detail-grid">
                  <div class="detail-item">
                    <label>ID:</label>
                    <span>{{ creditoDetalhes.id }}</span>
                  </div>
                  <div class="detail-item">
                    <label>N√∫mero do Cr√©dito:</label>
                    <span>{{ creditoDetalhes.numeroCredito }}</span>
                  </div>
                  <div class="detail-item">
                    <label>N√∫mero da NFS-e:</label>
                    <span>{{ creditoDetalhes.numeroNfse }}</span>
                  </div>
                  <div class="detail-item">
                    <label>Data de Constitui√ß√£o:</label>
                    <span>{{ formatDate(creditoDetalhes.dataConstituicao) }}</span>
                  </div>
                  <div class="detail-item">
                    <label>Valor ISSQN:</label>
                    <span class="currency">{{ formatCurrency(creditoDetalhes.valorIssqn) }}</span>
                  </div>
                  <div class="detail-item">
                    <label>Tipo do Cr√©dito:</label>
                    <span>{{ creditoDetalhes.tipoCredito }}</span>
                  </div>
                  <div class="detail-item">
                    <label>Simples Nacional:</label>
                    <app-badge [variant]="creditoDetalhes.simplesNacional ? 'success' : 'danger'">
                      {{ creditoDetalhes.simplesNacional ? 'Sim' : 'N√£o' }}
                    </app-badge>
                  </div>
                  <div class="detail-item">
                    <label>Al√≠quota:</label>
                    <span>{{ creditoDetalhes.aliquota }}%</span>
                  </div>
                  <div class="detail-item">
                    <label>Valor Faturado:</label>
                    <span class="currency">{{ formatCurrency(creditoDetalhes.valorFaturado) }}</span>
                  </div>
                  <div class="detail-item">
                    <label>Valor Dedu√ß√£o:</label>
                    <span class="currency">{{ formatCurrency(creditoDetalhes.valorDeducao) }}</span>
                  </div>
                  <div class="detail-item">
                    <label>Base de C√°lculo:</label>
                    <span class="currency">{{ formatCurrency(creditoDetalhes.baseCalculo) }}</span>
                  </div>
                </div>
              </div>
            </app-card>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>

